<script type="module">
import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm";

const supabaseUrl = "YOUR_SUPABASE_URL";
const supabaseKey = "YOUR_SUPABASE_ANON_KEY";
const supabase = createClient(supabaseUrl, supabaseKey);

window.submitAttendance = async function () {
  const phone = document.getElementById("phone").value;

  const { data: existing } = await supabase
    .from("attendance")
    .select("*")
    .eq("phone", phone)
    .is("check_out", null)
    .maybeSingle();

  if (!existing) {
    await supabase.from("attendance").insert({
      phone: phone,
      check_in: new Date()
    });
    document.getElementById("message").innerText = "Checked In";
  } else {
    await supabase
      .from("attendance")
      .update({ check_out: new Date() })
      .eq("id", existing.id);
    document.getElementById("message").innerText = "Checked Out";
  }
};
</script>
